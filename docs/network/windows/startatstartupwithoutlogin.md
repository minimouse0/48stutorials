# 系统启动完成后直接运行指定可执行或批处理文件而不需要登录

这个操作一般在需要服务器开机后直接恢复某些服务进程而不需要手动登录的时候使用，比如应对机房停电后重新开机、自动更新，让之前的服务进程自动恢复。下面这个是让服务器在不可预料的重新开机后能够自动恢复的解决办法。
> [!TIP]
> 这种情况不能用用户登录的那个开机自启文件夹来解决（win+r输入`shell:startup`），因为这个是用户级别的自启，必须用户登录之后才能触发，不是真正的开机自启，只是因为家用电脑开机之后必须登录才能开始使用才被一些人误解为是开机自启。  
> 其实也有不需要单独设置启动哪个文件，[开机后直接登录进桌面](network/windows/auto_login_at_startup.md)并启动所有`shell:startup`的快捷方式的办法，但是会导致电脑的安全性大大降低，不建议使用

1. win+r打开运行窗口，输入`taskschd.msc`回车，打开任务计划程序。
2. 点击进入侧边栏的**任务计划程序库**
3. 点击右侧操作一栏的**创建任务**
   1. 常规
      1. 名称：是你给这个开机自启计划起的名字，写什么不影响最后的执行结果
      2. 下方安全选项中，点击**不管用户是否登录都要运行**。如果你不清楚这个进程至少需要什么权限，勾上“使用最高权限运行”。
      3. 配置尽可能选择跟当前操作系统名一样的，比如Windows10系统就选Windows 10
         
    2. 触发器
        1. 点击**新建**
        2. 开始任务选择“启动时”
        3. 点击**确定**
    3. 操作
        1. 点击**新建**
        2. 操作选择**启动程序**
        3. 程序或脚本下，点击右侧的**浏览**，选择你要开机自启的可执行或批处理文件，也可以手动把文件的路径粘贴进去
        4. 把上面文件的路径后面的文件名去掉，填进下面的起始路径，比如文件路径是`C:\Users\Administrator\Documents\frpc\frpc.bat`，起始路径就是`C:\Users\Administrator\Documents\frpc\`。这里他虽然说可选但是必须得填
        5. 点击**确定**
    4. 条件
        1. 电源标题下，去掉**计算机使用交流电源时才启动此任务**的勾
        2. 勾上**唤醒计算机运行此任务**
        3. 点击**确定**
    5. 设置
        1. 勾上**如果过了计划开始时间，立即启动新任务**、**如果任务失败，按以下频率重新启动：**，
        2. 去掉**如果任务运行时间超过以下时间，停止任务：** 的勾
        3. 点击**确定**
    6. 点击**确定**，输入服务器密码

此时上方的列表中应该就有你创建的任务了。这样创建的开机自启会在启动后静默运行，不会显示在你的桌面上。

> [!TIP]
> 这种方法还可以防止登出时它开机启动的进程被杀死，导致一些重要的进程如用于远程桌面的代理关闭造成服务器失联
  
       
